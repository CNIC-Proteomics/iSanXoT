<template class="task-template" id="panel-main_inputs">
<div id="panel-main_inputs">

  <div class="form-group">
    <h6 for="select-indir">Select input folder</h6>  
    <div class="input-group col-sm">
      <input type="text" class="form-control" placeholder="" id="indir">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary btn-sm select-indir" type="button">Choose folder</button>
      </div>
    </div>
  </div>

  <div class="form-group">
    <h6 for="select-outdir">Select output folder</h6>
    <div class="input-group col-sm">
      <input type="text" class="form-control" placeholder="" id="outdir">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary btn-sm select-outdir" type="button">Choose folder</button>
      </div>
    </div>
  </div>

  <div class="form-group">
    <h6 for="select-species">Select Species</h6>
    <div class="input-group col-sm">
      <select class="custom-select" id="species">
        <option value="Homo sapiens">Human</option>
        <option value="Mus musculus">Mouse</option>
        <option value="Sus scrofa">Pig</option>
      </select>
    </div>
  </div>

  <div class="form-group">
    <h6 for="select-dbfile">Select protein database</h6>
    <div class="form-group row">
      <div class="form-group row col-sm">
        <select class="custom-select def-dbfile">
          <option value="human">Human protein database</option>
          <option value="mouse">Mouse protein database</option>
          <option value="pig">Pig protein database</option>
          <option value="personal">User-provided protein database...</option>
        </select>
      </div>
      <div class="form-group row col-sm">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Select your protein database file" id="dbfile" value="" disabled="">
          <div class="input-group-append">
            <button class="btn btn-outline-secondary btn-sm select-dbfile" type="button" disabled="">Select file</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="form-group">
    <h6 for="select-catfile">Select protein-category relation file</h6>
    <div class="form-group row">
      <div class="form-group row col-sm">
        <select class="custom-select def-catfile">
          <option value="human">Human protein-category relation file</option>
          <option value="mouse">Mouse protein-category relation file</option>
          <option value="pig">Pig protein-category relation file</option>
          <option value="personal">User-provided protein-category relation file...</option>
        </select>
      </div>
      <div class="form-group row col-sm">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Select your protein-category relation file" id="catfile" value="" disabled="">
          <div class="input-group-append">
            <button class="btn btn-outline-secondary btn-sm select-catfile" type="button" disabled="">Select file</button>
          </div>
        </div>
      </div>
    </div>
  </div>  
  <h6>Select input files</h6>

</div>
<script>
// Add values to Main_Inputs panel, if apply
function addValuesMainInputsPanel() {
  // Imported variables
  let remote = require('electron').remote;
  let dialog = remote.dialog;
  let exceptor = require(`${__dirname}/renderer-process/exceptor`);
  let importer = require(`${__dirname}/renderer-process/imports`);
  let wf_exec  = importer.wf_exec;
  let wk_id = importer.getWorkIDFromElements(); // get current work id
  let cmd_id = importer.getCmdIDFromElements(); // get the current cmd id

  if ( 'main_inputs' === wk_id ) {
    // Add main inputs
    if ( wf_exec !== undefined ) {
      if ( 'main_inputs' in wf_exec ) {
        $(`#${wk_id} #page-tasktable-${cmd_id} #indir`).val(`${wf_exec['main_inputs']['indir']}`);
        $(`#${wk_id} #page-tasktable-${cmd_id} #outdir`).val(`${wf_exec['main_inputs']['outdir']}`);
        $(`#${wk_id} #page-tasktable-${cmd_id} #species`).val(`${wf_exec['main_inputs']['species']}`);
        $(`#${wk_id} #page-tasktable-${cmd_id} .def-dbfile`).val(`personal`);
        $(`#${wk_id} #page-tasktable-${cmd_id} #dbfile`).val(`${wf_exec['main_inputs']['dbfile']}`);
        $(`#${wk_id} #page-tasktable-${cmd_id} #dbfile`).prop('disabled', false);
        $(`#${wk_id} #page-tasktable-${cmd_id} .def-catfile`).val(`personal`);
        $(`#${wk_id} #page-tasktable-${cmd_id} #catfile`).val(`${wf_exec['main_inputs']['catfile']}`);
        $(`#${wk_id} #page-tasktable-${cmd_id} #catfile`).prop('disabled', false);
      }
    }
  }
  
  /*
   * Events
   */
  // local function for events
  function addInputsFileDirectoy(id, inputs, errsms) {
    if(inputs === undefined) {
      console.log(`${errsms}: input is undefined`);
      exceptor.showMessageBox('Error Message', `${errsms}`);
    }
    else if (inputs.canceled) {
      console.log(`${errsms}: canceled operation`);
    }
    else if (!('filePaths' in inputs )) {
      console.log(`${errsms}: filePaths does not defined`);
      exceptor.showMessageBox('Error Message', `${errsms}`);
    }
    else {
      if ( inputs['filePaths'].length == 0 ) {
        console.log(`${errsms}: filePaths is empty`);
        exceptor.showMessageBox('Error Message', `${errsms}`);
      }
      else {
        let file = inputs['filePaths'][0];
        $(`${id}`).val(`${file}`);
      }
    }
  };
  // events for the INPUT directory and OUTPUT directory
  $(`#${wk_id} #page-tasktable-${cmd_id} button.select-indir`).click(function() {
    dialog.showOpenDialog({ properties: ['openDirectory'] }).then((dirs) => {
      addInputsFileDirectoy(`#${wk_id} #page-tasktable-${cmd_id} #indir`, dirs, `No input directory selected`);
    });
  });
  $(`#${wk_id} #page-tasktable-${cmd_id} button.select-outdir`).click(function() {
    dialog.showOpenDialog({ properties: ['openDirectory'] }).then((dirs) => {
      addInputsFileDirectoy(`#${wk_id} #page-tasktable-${cmd_id} #outdir`, dirs, `No output directory selected`);
    });
  });

  // events for the DB file and CATegory file BUTTON
  $(`#${wk_id} #page-tasktable-${cmd_id} button.select-dbfile`).click(function() {
    dialog.showOpenDialog({ properties: ['openFile'] }).then((files) => {
      addInputsFileDirectoy(`#${wk_id} #page-tasktable-${cmd_id} #dbfile`, files, `No database file selected`);
    });
  });
  $(`#${wk_id} #page-tasktable-${cmd_id} button.select-catfile`).click(function() {
    dialog.showOpenDialog({ properties: ['openFile'] }).then((files) => {
      addInputsFileDirectoy(`#${wk_id} #page-tasktable-${cmd_id} #catfile`, files, `No category file seleted`);
    });
  });

  // events for the DB file and CATegory file SELECT DOWNLIST
  $(`#${wk_id} #page-tasktable-${cmd_id} .def-dbfile`).change(function() {
    if ( this.value === "personal" ) {
      $(`#${wk_id} #page-tasktable-${cmd_id} #dbfile`).prop('disabled', false);
      $(`#${wk_id} #page-tasktable-${cmd_id} .select-dbfile`).prop('disabled', false);
    }
    else {
      $(`#${wk_id} #page-tasktable-${cmd_id} #dbfile`).prop('disabled', true);
      $(`#${wk_id} #page-tasktable-${cmd_id} .select-dbfile`).prop('disabled', true);
    }
  });
  $(`#${wk_id} #page-tasktable-${cmd_id} .def-catfile`).change(function() {
    if ( this.value === "personal" ) {
      $(`#${wk_id} #page-tasktable-${cmd_id} #catfile`).prop('disabled', false);
      $(`#${wk_id} #page-tasktable-${cmd_id} .select-catfile`).prop('disabled', false);
    }
    else {
      $(`#${wk_id} #page-tasktable-${cmd_id} #catfile`).prop('disabled', true);
      $(`#${wk_id} #page-tasktable-${cmd_id} .select-catfile`).prop('disabled', true);
    }
  });

}
// Create object with the Main_Inputs data extracting from the HTML Elements
function createObjFromMainInputsPanel() {
  let rst = {};
  let main_inputs = $(`#panel-main_inputs [id]`);
  for (var i = 0; i < main_inputs.length; i++) {
    let inp = main_inputs[i];
    let id = $(inp).attr('id');
    let val = $(inp).val();
    rst[id] = val;
  }
  return rst;
}

</script>
</template>