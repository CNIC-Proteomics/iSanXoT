<template class="task-template" id="panel-main_inputs">
  
<div id="panel-simple">
  <div class="helpadv">
    <svg class="bi text-info" width="30" height="30" fill="currentColor"><use xlink:href="assets/icons/bootstrap-icons-1.3.0/bootstrap-icons.svg#info-square-fill" /></svg>
  </div>
  <div class="help_modal"></div>
</div>

<div id="paneladaptor-main_inputs">

  <div class="form-group">
    <h6>Project folder</h6>
    <div class="input-group col-sm  adaptor_inputs" id="__OUTDIR__">
      <input type="text" class="form-control" placeholder=""  value="">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary btn-sm" type="button">Choose folder</button>
      </div>
    </div>  
  </div>

  <div class="form-group">
    <h6>Input Identification file</h6>
    <div class="input-group col-sm  adaptor_inputs" id="__IDQ_FILE__">
      <input type="text" class="form-control" placeholder=""  value="">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary btn-sm" type="button">Choose file</button>
      </div>
    </div>
  </div>
  
</div>

<script>

/* Declare variables */
let remote = require('electron').remote;
let mainWindow = remote.getCurrentWindow();
let dialog = remote.dialog;

/* Local Functions */
function extractInputDirectoryFile(inputs, errsms) {
  let out = undefined;
  if(inputs === undefined) {
    console.log(`${errsms}: input is undefined`);
    exceptor.showErrorMessageBox('Error Message', `${errsms}`);
  }
  else if (inputs.canceled) {
    console.log(`${errsms}: canceled operation`);
  }
  else if (!('filePaths' in inputs )) {
    console.log(`${errsms}: filePaths does not defined`);
    exceptor.showErrorMessageBox('Error Message', `${errsms}`);
  }
  else {
    if ( inputs['filePaths'].length == 0 ) {
      console.log(`${errsms}: filePaths is empty`);
      exceptor.showErrorMessageBox('Error Message', `${errsms}`);
    }
    else {
      out = inputs['filePaths'][0];
    }
  }
  return out;
};

/* Local Events */
$('#__OUTDIR__  button').click(function() {
  dialog.showOpenDialog(mainWindow, { properties: ['openDirectory'] }).then((dirs) => {
    let inpt = extractInputDirectoryFile(dirs, `No output directory selected`);
    console.log( "OUTDIR");
    if ( inpt !== undefined ) {
      $(`#__OUTDIR__ input`).val(`${inpt}`);
    }
  });
});
$('#__IDQ_FILE__  button').click(function() {
  dialog.showOpenDialog(mainWindow, { properties: ['openFile'] }).then((dirs) => {
    let inpt = extractInputDirectoryFile(dirs, `No input file selected`);
    if ( inpt !== undefined ) {
      $(`#__IDQ_FILE__ input`).val(`${inpt}`);
    }
  });
});

/* Functions that chech the inputs */
function checkInputFile(input, errsms, exceptor) {
  let fs = require('fs');
  if ( $(`${input}`).val() === undefined || $(`${input}`).val() === '' ) {
      console.log(`${errsms}: input is undefined`);
      exceptor.showErrorMessageBox('Error Message', `${errsms}`);
    }
    else {
      try {
        if ( !fs.existsSync($(`${input}`).val()) ) {
          console.log(`${errsms}: input is undefined`);
          exceptor.showErrorMessageBox('Error Message', `${errsms}`);
        }
      } catch(err) {
        console.log(`${errsms}: input is undefined`);
        exceptor.showErrorMessageBox('Error Message', `${errsms}`);
      }
    }
    return;
};
/* The name and the parameters of this function has to be the same in the adaptors */
function checkAdaptorInputs(exceptor) {
  checkInputFile(`#__IDQ_FILE__ input`, `Input file has not been included`, exceptor);
  checkInputFile(`#__OUTDIR__ input`, `Output folder has not been included`, exceptor);
};

</script>
</template>